<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{% block title %}Plant Monitor{% endblock %}</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            brand: {
                                DEFAULT: "#15803d",
                                dark: "#14532d",
                                light: "#bbf7d0",
                            },
                        },
                    },
                },
            };
        </script>
    </head>
    <body class="min-h-screen bg-slate-950 text-white antialiased">
        <header
            class="border-b border-white/10 bg-gradient-to-r from-emerald-900/90 to-slate-950/90 backdrop-blur"
        >
            <div
                class="mx-auto flex max-w-6xl flex-wrap items-center justify-between gap-4 px-6 py-4"
            >
                <a
                    href="/"
                    class="text-lg font-semibold tracking-tight text-white"
                    >Plant Monitor</a
                >
                <nav
                    class="flex flex-wrap items-center gap-4 text-sm text-slate-200"
                >
                    <a href="/" class="transition hover:text-white">Home</a>
                    <a href="/app-download" class="transition hover:text-white"
                        >Mobile app</a
                    >
                    {% if request.session.get('user_email') %}
                    <a href="/web" class="transition hover:text-white"
                        >Dashboard</a
                    >
                    {% if request.session.get('is_admin') %}
                    <a href="/web/admin" class="transition hover:text-white"
                        >Admin</a
                    >
                    {% endif %}
                    <span class="hidden text-xs text-slate-400 sm:block"
                        >Signed in as {{ request.session.get('user_email')
                        }}</span
                    >
                    <a
                        href="/web/logout"
                        class="rounded-full bg-white/10 px-4 py-1 text-white transition hover:bg-white/20"
                        >Logout</a
                    >
                    {% else %}
                    <a href="/web/login" class="transition hover:text-white"
                        >Login</a
                    >
                    <a
                        href="/web/register"
                        class="rounded-full bg-brand px-4 py-1 text-sm font-semibold text-white shadow-lg shadow-emerald-500/30 transition hover:bg-brand-dark"
                    >
                        Get started
                    </a>
                    {% endif %}
                </nav>
            </div>
        </header>
        <main
            class="flex-1 bg-gradient-to-b from-slate-950 via-slate-950 to-slate-900"
        >
            <div class="mx-auto w-full max-w-6xl px-4 py-10 sm:px-6 lg:px-8">
                {% block content %}{% endblock %}
            </div>
        </main>
        <footer class="border-t border-white/10 bg-slate-950/90">
            <div
                class="mx-auto flex max-w-6xl flex-col gap-2 px-6 py-6 text-sm text-slate-500 sm:flex-row sm:items-center sm:justify-between"
            >
                <p>&copy; Plant Monitor</p>
                <div class="flex gap-4">
                    <a
                        href="https://github.com/And329"
                        class="transition hover:text-white"
                        >GitHub</a
                    >
                    <a
                        href="mailto:support@example.com"
                        class="transition hover:text-white"
                        >Support</a
                    >
                </div>
            </div>
        </footer>
        <script>
            function formatRelative(seconds) {
                if (seconds <= 0) return "just now";
                if (seconds < 60) return `${seconds}s ago`;
                if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;
                if (seconds < 86400)
                    return `${Math.floor(seconds / 3600)}h ago`;
                return `${Math.floor(seconds / 86400)}d ago`;
            }
            function updateRelativeTimestamps() {
                const elements = document.querySelectorAll(
                    "[data-last-seen-iso]",
                );
                const now = Date.now();
                elements.forEach((el) => {
                    const iso = el.dataset.lastSeenIso;
                    if (!iso) return;
                    const timestamp = Date.parse(iso);
                    if (!Number.isNaN(timestamp)) {
                        const seconds = Math.max(
                            0,
                            Math.floor((now - timestamp) / 1000),
                        );
                        el.textContent = formatRelative(seconds);
                    }
                });
            }
            window.addEventListener("DOMContentLoaded", () => {
                updateRelativeTimestamps();
                setInterval(updateRelativeTimestamps, 1000);
            });
        </script>
        {% block extra_scripts %}{% endblock %}
    </body>
</html>
